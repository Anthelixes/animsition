/*!
 * animsition v4.0.0-alpha.1
 * A simple and easy jQuery plugin for CSS animated page transitions.
 * http://git.blivesta.com/animsition
 * License : MIT
 * Author : Yasuyuki Enomoto <enmt@blivesta.com> (http://blivesta.com/)
 */
!function(n){"use strict";"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof exports?module.exports=n(require("jquery")):n(jQuery)}(function(n){"use strict";var i="animsition",t={counts:{},init:function(o){t.counts.init=[],t.counts["in"]=[],t.counts.out=[],o=n.extend({inClass:"fade-in",outClass:"fade-out",inDuration:1,outDuration:1,inDelay:0,outDelay:0,linkElement:".animsition-link",loading:!0,loadingClass:"animsition-loading",loadingWrapClass:"animsition-wrap",loadingInnerHtml:"",timeout:!0,timeoutCountdown:6,timeoutFunction:function(){},transition:function(n){window.location.href=n},unSupportCss:["animation-duration","-webkit-animation-duration","-o-animation-duration"]},o);var a=t.supportCheck.call(this,o);return a?(o.timeout&&t.setCountdown.call(this,o),this.each(function(a){var s=this,e=n(this),r=n(window),u=e.data(i);u||(o=n.extend({},o),e.data(i,{options:o}),o.loading&&t.addLoading.call(s),t.counts.init.push(a),r.on("unload."+i,function(){}),n(o.linkElement).on("click."+i,function(i){i.preventDefault();var o=n(this),a=o.attr("href");return 2===i.which||i.metaKey||i.shiftKey||-1!==navigator.platform.toUpperCase().indexOf("WIN")&&i.ctrlKey?window.open(a,"_blank"):t.out.call(s,o,a)}))})):("console"in window||(window.console={},window.console.log=function(n){return n}),console.log("Animsition does not support this browser."),t.destroy.call(this))},addLoading:function(){var t=n(this),o=t.data(i).options,a='<div class="'+o.loadingWrapClass+'"></div>',s='<div class="'+o.loadingClass+'">'+o.loadingInnerHtml+"</div>";t.wrap(a);var e=t.parent("."+o.loadingWrapClass);return e.append(s)},removeLoading:function(){var t=n(this),o=t.data(i).options,a=t.siblings("."+o.loadingClass);return a.remove(),t.unwrap()},supportCheck:function(i){var t=n(this),o=i.unSupportCss,a=o.length,s=!1;0===a&&(s=!0);for(var e=0;a>e;e++)if("string"==typeof t.css(o[e])){s=!0;break}return s},"in":function(o,a){var s=this,e=n(this),r=e.data(i);if(r){var u=e.data("animsition-in-class"),l=e.data("animsition-in-delay"),d=e.data("animsition-in-duration");return a=n.extend(r.options,{inClass:u,inDelay:l,inDuration:d},a),a.timeout&&0===t.counts["in"].length&&t.clearCountdown.call(s),a.loading&&t.removeLoading.call(s),e.trigger("animsition.inStart").css({"animation-duration":a.inDuration+"s","animation-delay":a.inDelay+"s"}).addClass(a.inClass).animsitionCallback(function(){return e.removeClass(a.inClass).css({opacity:1,"animation-delay":"0s"}).trigger("animsition.inEnd"),t.counts["in"].push(a.inClass),t.counts.init.length===t.counts["in"].length?e.trigger("animsition.inDone"):void 0})}},out:function(o,a,s){var e=n(this),r=e.data(i);if(r){var u=o.data("animsition-out-class"),l=e.data("animsition-out-class"),d=o.data("animsition-out-delay"),c=e.data("animsition-out-delay"),m=o.data("animsition-out-duration"),f=e.data("animsition-out-duration"),p=void 0!==u?u:l,g=void 0!==d?d:c,h=void 0!==m?m:f;return s=n.extend(r.options,{outClass:p,outDelay:g,outDuration:h},s),e.trigger("animsition.outStart").css({"animation-duration":s.outDuration+"s","animation-delay":s.outDelay+"s"}).addClass(s.outClass).animsitionCallback(function(){return t.counts.out.push(s.outClass),e.trigger("animsition.outEnd"),t.counts["in"].length===t.counts.out.length?(e.trigger("animsition.outDone"),s.transition(a)):void 0})}},setCountdown:function(i){var o=this,a=n(this);t.counts.timer=[],t.counts.timer=setTimeout(function(){return a.trigger("animsition.timeout"),t.clearCountdown.call(o),i.timeoutFunction()},1e3*i.timeoutCountdown)},clearCountdown:function(){return clearTimeout(t.counts.timer)},destroy:function(){return this.each(function(){var t=n(this);n(window).unbind("."+i),t.css({opacity:1}).removeData(i)})}};n.fn.animsitionCallback=function(i){var t="animationend webkitAnimationEnd mozAnimationEnd oAnimationEnd MSAnimationEnd";return this.each(function(){var o=n(this);o.bind(t,function(){return o.unbind(t),i.call(this)})})},n.fn.animsition=function(o){return t[o]?t[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void n.error("Method "+o+" does not exist on jQuery."+i):t.init.apply(this,arguments)}});